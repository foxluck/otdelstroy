$.extend({createUploadIframe:function(a,b){var c='jUploadFrame'+a;if(window.ActiveXObject){var d=document.createElement('<iframe id="'+c+'" name="'+c+'" />');if(typeof b=='boolean')d.src='javascript:false';else if(typeof b=='string')d.src=b}else{var d=document.createElement('iframe');d.id=c;d.name=c}d.style.position='absolute';d.style.top='-1000px';d.style.left='-1000px';document.body.appendChild(d);return d},createUploadForm:function(a,b){var c='jUploadForm'+a;var d='jUploadFile'+a;var e=$('<form  action="" method="POST" name="'+c+'" id="'+c+'" enctype="multipart/form-data"></form>');var f=$('#'+b);var g=$(f).clone();$(f).attr('id',d);$(f).before(g);$(f).appendTo(e);$(e).css('position','absolute');$(e).css('top','-1200px');$(e).css('left','-1200px');$(e).appendTo('body');return e},ajaxFileUpload:function(s){s=$.extend({},$.ajaxSettings,s);var f=new Date().getTime();var g=$.createUploadForm(f,s.fileElementId);var h=$.createUploadIframe(f,s.secureuri);var i='jUploadFrame'+f;var j='jUploadForm'+f;if(s.global&&!$.active++){$.event.trigger("ajaxStart")};var k=false;var l={};if(s.global)$.event.trigger("ajaxSend",[l,s]);var m=function(a){var b=document.getElementById(i);try{if(b.contentWindow){l.responseText=b.contentWindow.document.body?b.contentWindow.document.body.innerHTML:null;l.responseXML=b.contentWindow.document.XMLDocument?b.contentWindow.document.XMLDocument:b.contentWindow.document}else if(b.contentDocument){l.responseText=b.contentDocument.document.body?b.contentDocument.document.body.innerHTML:null;l.responseXML=b.contentDocument.document.XMLDocument?b.contentDocument.document.XMLDocument:b.contentDocument.document}}catch(e){$.handleError(s,l,null,e)}if(l||a=="timeout"){k=true;var c;try{c=a!="timeout"?"success":"error";if(c!="error"){var d=$.uploadHttpData(l,s.dataType);if(s.success){eval("var j="+d);s.success(j,c)};if(s.global)$.event.trigger("ajaxSuccess",[l,s])}else $.handleError(s,l,c)}catch(e){c="error";$.handleError(s,l,c,e)}if(s.global)$.event.trigger("ajaxComplete",[l,s]);if(s.global&&!--$.active)$.event.trigger("ajaxStop");if(s.complete)s.complete(l,c);$(b).unbind();setTimeout(function(){try{$(b).remove();$(g).remove()}catch(e){$.handleError(s,l,null,e)}},100);l=null}};if(s.timeout>0){setTimeout(function(){if(!k)m("timeout")},s.timeout)}try{var g=$('#'+j);$(g).attr('action',s.url);$(g).attr('method','POST');$(g).attr('target',i);if(g.encoding)g.encoding='multipart/form-data';else g.enctype='multipart/form-data';$(g).submit()}catch(e){$.handleError(s,l,null,e)}if(window.attachEvent)document.getElementById(i).attachEvent('onload',m);else document.getElementById(i).addEventListener('load',m,false);return{abort:function(){}}},uploadHttpData:function(r,a){var b=!a;b=a=="xml"||b?r.responseXML:r.responseText;if(a=="script")$.globalEval(b);if(a=="json")eval("data = "+b);if(a=="html")$("<div>").html(b).evalScripts();return b}})
